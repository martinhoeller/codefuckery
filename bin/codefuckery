#!/usr/bin/env ruby

require 'clamp'
require_relative '../lib/codefuckery'

Clamp do
    parameter "DIRECTORY", "Source directory to be checked", :attribute_name => :directory
    
    option ["--filetypes", "-f"], "FILETYPES", "Comma-delimited list of file types, e.g.: rb,java,swift. By default all files are checked.", default: '' do |s|
        s.split(/\s*,\s*/).map { |ext| ".#{ext}"}
    end

    option ["--[no-]recursive"], :flag, "Recursively check files in DIRECTORY and all sub-directories.", default: true

    option ["--version", "-v"], :flag, "Shows codefuckery version" do
        puts "codefuckery #{Codefuckery::VERSION}"
        exit(0)
    end

    def execute
        #TODO configurable word list
        counter = Codefuckery::Counter.count(directory, filetypes, Codefuckery::DEFAULT_WORDS, recursive?)
    end
end